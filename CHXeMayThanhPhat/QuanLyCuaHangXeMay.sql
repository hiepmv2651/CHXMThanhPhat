CREATE DATABASE QUANLYCUAHANGXE
USE QUANLYCUAHANGXE

CREATE TABLE NHANVIEN(
	MANV VARCHAR(20) PRIMARY KEY,
	TENNV NVARCHAR(30) NOT NULL,
	NGAYSINH DATETIME NOT NULL,
	SDT VARCHAR(20) NOT NULL,
	DIACHI NVARCHAR(30),
	NGAYLAM VARCHAR(20),
	LUONG FLOAT NOT NULL,
)

CREATE TABLE LOAIXE(
	MALOAI VARCHAR(20) PRIMARY KEY,
	TENLOAI NVARCHAR(30) NOT NULL,
)

CREATE TABLE NHACUNGCAP(
	MANCC VARCHAR(20) PRIMARY KEY,
	TENNCC NVARCHAR(30) NOT NULL,
	SOLUONG INT NOT NULL,
	DIACHI NVARCHAR(30) NOT NULL,
	SDT VARCHAR(20) NOT NULL
)

CREATE TABLE XE(
	MAXE VARCHAR(20) PRIMARY KEY,
	TENXE NVARCHAR(30) NOT NULL,
	MALOAI VARCHAR(20) FOREIGN KEY REFERENCES LOAIXE(MALOAI),
	MANCC VARCHAR(20) FOREIGN KEY REFERENCES NHACUNGCAP(MANCC),
	SOLUONG INT NOT NULL,
	GIA FLOAT NOT NULL, 
)

CREATE TABLE KHACHHANG(
	MAKH VARCHAR(20) PRIMARY KEY,
	TENKH NVARCHAR(30) NOT NULL,
	DIACHI NVARCHAR(30) NOT NULL,
	SDT VARCHAR(20) NOT NULL,
)

CREATE TABLE BAOHANH(
	MABH VARCHAR(20) PRIMARY KEY,
	MAXE VARCHAR(20) FOREIGN KEY REFERENCES XE(MAXE),
	MANV VARCHAR(20) FOREIGN KEY REFERENCES NHANVIEN(MANV),
	MAKH VARCHAR(20) FOREIGN KEY REFERENCES KHACHHANG(MAKH),
)

CREATE TABLE HOADONNHAP(
	MAHDN VARCHAR(20) PRIMARY KEY,
	MANV VARCHAR(20) FOREIGN KEY REFERENCES NHANVIEN(MANV),
	MANCC VARCHAR(20) FOREIGN KEY REFERENCES NHACUNGCAP(MANCC),
	NGAYNHAP DATE NOT NULL,
)

CREATE TABLE CHITIETHOADONNHAP(
	MAHDN VARCHAR(20) FOREIGN KEY REFERENCES HOADONNHAP(MaHDN),
	MAXE VARCHAR(20) FOREIGN KEY REFERENCES XE(MAXE),
	DONGIA FLOAT NOT NULL,
	SOLUONG INT NOT NULL,
	TONGTIEN FLOAT NOT NULL,
	CONSTRAINT PK_HDN PRIMARY KEY(MAHDN, MAXE)
)

CREATE TABLE HOADONXUAT(
	MAHDX VARCHAR(20) PRIMARY KEY,
	MANV VARCHAR(20) FOREIGN KEY REFERENCES NHANVIEN(MANV),
	MAKH VARCHAR(20) FOREIGN KEY REFERENCES KHACHHANG(MAKH),
	NGAYXUAT DATE NOT NULL,
)

CREATE TABLE CHITIETHOADONXUAT(
	MAHDX VARCHAR(20) NOT NULL,
	MAXE VARCHAR(20) NOT NULL,
	DONGIA FLOAT NOT NULL, 
	SOLUONG INT NOT NULL, 
	TONGTIEN FLOAT NOT NULL,
	CONSTRAINT PK_HDX PRIMARY KEY (MAHDX,MAXE),
	CONSTRAINT FK_CTHDX_XE FOREIGN KEY (MAXE) REFERENCES Xe(MAXE),
	CONSTRAINT FK_CTHDX_HDX FOREIGN KEY (MAHDX) REFERENCES HOADONXUAT(MAHDX),
)

-- Nhập Dữ Liệu ---
INSERT INTO dbo.NHANVIEN (MANV, TENNV, NGAYSINH, SDT, DIACHI, NGAYLAM, LUONG)
VALUES ('NV101',N'Võ Tấn Khuê', '2001-09-06', '0987664220',N'18 Nguyễn Hùng, Nha Trang','2020-09-06',1000000.0),
	   ('NV102',N'Nguyễn Trần Hùng', '2001-12-06', '0987664220',N'343 Trịnh Phong, Vạn Giã','2020-09-05',2000000.0),
	   ('NV103',N'Mạnh Văn Hiệp', '1999-04-05', '0987664220',N'324 Cam Đức, Cam Ranh','2020-09-07',1000000.0),
	   ('NV104',N'Nguyễn Văn An', '1995-10-10', '0987664220',N'Sông Cầu, Phú Yên','2020-09-08',3000000.0),
	   ('NV105',N'Võ Đại Tài', '2002-12-05', '0987664220',N'18 Đức Hà, Hà Nội','2020-09-09',4000000.0)

INSERT INTO dbo.LOAIXE (MALOAI, TENLOAI)
VALUES ('HD1',N'Honda'),
	   ('YM1',N'Yamaha'),
	   ('HD2',N'Honda2'),
	   ('AB1',N'AirBlade'),
	   ('SYM1',N'Sanyang')

INSERT INTO dbo.NHACUNGCAP (MANCC, TENNCC, SOLUONG, DIACHI,SDT)
VALUES ('NCC1','Anh Hùng',10,N'8 Trịnh Phong, Nha Trang','098763754220'),
	   ('NCC2','Anh Sơn',11, N'9 Mê Linh, Nha Trang','038445345'),
	   ('NCC3','Anh Đức',12,N'13 Cam Nghĩa, Cam Ranh','04213323450'),
	   ('NCC4','Anh Ngọc',13,N'89 Quốc Lộ 1','0353453420'),
	   ('NCC5','Chị Thương',14,N'499 Hùng Vương, Nha Trang','0546464420')

INSERT INTO dbo.XE (MAXE, TENXE, MALOAI, MANCC, SOLUONG, GIA)
VALUES ('MX1',N'HonDa2019','HD1','NCC1',10,100000.0),
	   ('MX2',N'YamahaY','YM1','NCC2',11,200000.0),
	   ('MX3',N'Honda2022','HD2','NCC3',12,150000.0),
	   ('MX4',N'AirBladeX','AB1','NCC4',13,130000.0),
	   ('MX5',N'Sanyang2019','SYM1','NCC5',14,210000.0)

INSERT INTO dbo.KHACHHANG (MAKH, TENKH, DIACHI, SDT)
VALUES ('KH1',N'Nguyễn Đức Tài',N'01 Nguyễn Đình Chiểu','0935323446'),
	   ('KH2',N'Trình Huy Vũ',N'02 Nguyễn Huệ','098756866'),
	   ('KH3',N'Nguyễn Tuấn Anh',N'01 Nguyễn Chí Thanh','094355756'),
	   ('KH4',N'Phạm Thị Ngọc',N'211 Phan Đình Phùng','0945464646'),
	   ('KH5',N'Vũ Đức Huy',N'488 Trần Phú, Nha Trang','0876488747')

INSERT INTO dbo.BAOHANH (MABH, MAXE, MANV, MAKH)
VALUES ('BH1','MX1','NV101','KH1'),
	   ('BH2','MX2','NV102','KH2'),
	   ('BH3','MX3','NV103','KH3'),
	   ('BH4','MX4','NV104','KH4'),
	   ('BH5','MX5','NV105','KH5')

INSERT INTO dbo.HOADONNHAP (MAHDN, MANV, MANCC, NGAYNHAP)
VALUES ('HDN1','NV101','NCC1','2021-10-12'),
	   ('HDN2','NV102','NCC2','2021-10-13'),
	   ('HDN3','NV103','NCC3','2021-10-14'),
	   ('HDN4','NV104','NCC4','2021-10-15'),
	   ('HDN5','NV105','NCC5','2021-10-16')

INSERT INTO dbo.CHITIETHOADONNHAP (MAHDN, MAXE, DONGIA, SOLUONG, TONGTIEN)
VALUES ('HDN1','MX1',100000.0,1,100000.0),
	   ('HDN2','MX2',200000.0,2,400000.0),
	   ('HDN3','MX3',150000.0,1,150000.0),
	   ('HDN4','MX4',130000.0,2,260000.0),
	   ('HDN5','MX5',210000.0,1,210000.0)

INSERT INTO dbo.HOADONXUAT (MAHDX, MANV, MAKH, NGAYXUAT)
VALUES ('HDX1','NV101','KH1','2021-11-12'),
	   ('HDX2','NV102','KH2','2021-11-13'),
	   ('HDX3','NV103','KH3','2021-11-14'),
	   ('HDX4','NV104','KH4','2021-11-15'),
	   ('HDX5','NV105','KH5','2021-11-16')

INSERT INTO dbo.CHITIETHOADONXUAT (MAHDX, MAXE, DONGIA, SOLUONG, TONGTIEN)
VALUES ('HDX1','MX1',100000.0,1,100500.0),
	   ('HDX2','MX2',200000.0,1,200500.0),
	   ('HDX3','MX3',150000.0,1,150500.0),
	   ('HDX4','MX4',130000.0,1,130500.0),
	   ('HDX5','MX5',210000.0,1,210500.0)


--- Truy Vấn ---
